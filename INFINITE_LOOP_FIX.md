# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ ReferralModal

## –î–∞—Ç–∞: 2025-01-27

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏.

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ö—É–∫–µ `useModalData` —Ñ—É–Ω–∫—Ü–∏—è `load` –∑–∞–≤–∏—Å–µ–ª–∞ –æ—Ç `loadData` –∏ `onError` –≤ `useCallback`, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –∫–∞–∫ –∏–Ω–ª–∞–π–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ. –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ `load`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ `useEffect`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –Ω–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä - –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª.

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥:**
```typescript
const load = useCallback(async () => {
  // ...
  const result = await loadData(); // loadData –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
  // ...
  if (onError) {
    onError(err); // onError —Ç–æ–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
  }
}, [loadData, onError]); // ‚ùå –≠—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–Ω—è—é—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

useEffect(() => {
  if (isOpen) {
    load();
  }
}, [isOpen, load, ...deps]); // ‚ùå load –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useRef` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π `loadData` –∏ `onError`, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –≤–ª–∏—è–ª–∏ –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `useCallback`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥:**
```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º ref –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π loadData –∏ onError
const loadDataRef = useRef(loadData);
const onErrorRef = useRef(onError);

// –û–±–Ω–æ–≤–ª—è–µ–º ref –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ loadData –∏ onError
useEffect(() => {
  loadDataRef.current = loadData;
  onErrorRef.current = onError;
}, [loadData, onError]);

const load = useCallback(async () => {
  try {
    setIsLoading(true);
    setError(null);
    const result = await loadDataRef.current(); // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º ref
    setData(result);
    return result;
  } catch (err) {
    setError(err);
    if (onErrorRef.current) {
      onErrorRef.current(err); // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º ref
    }
    throw err;
  } finally {
    setIsLoading(false);
  }
}, []); // ‚úÖ –¢–µ–ø–µ—Ä—å load –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç loadData –∏ onError

useEffect(() => {
  if (isOpen) {
    load();
  }
  // eslint-disable-next-line react-hooks/exhaustive-deps
}, [isOpen, load, ...deps]); // ‚úÖ load —Ç–µ–ø–µ—Ä—å —Å—Ç–∞–±–∏–ª—å–Ω–∞
```

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è

### `hooks/useModalData.ts`

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `useRef` –¥–ª—è `loadData` –∏ `onError`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `useEffect` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ref –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π
3. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω `load` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ref –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. ‚úÖ `load` –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `loadData` –∏ `onError` –≤ `useCallback`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∏:

- ‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –õ–∏–Ω—Ç–µ—Ä: 0 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- ‚úÖ –¢–µ—Å—Ç—ã: 66/66 –ø—Ä–æ–π–¥–µ–Ω–æ

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- ‚ùå –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞–¥–∞–ª–∞ –∏–∑-–∑–∞ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏
- ‚úÖ –ù–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞

---

## üìö –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—á–µ–º—É `useRef` —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É?

`useRef` —Å–æ–∑–¥–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∞—Ö. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
1. –•—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π `useCallback`
2. –ò–∑–±–µ–∂–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `ref.current`

### –ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?

- `useEffect` –æ–±–Ω–æ–≤–ª—è–µ—Ç ref –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `loadData` –∏–ª–∏ `onError`
- `load` –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `ref.current`
- –ù–µ—Ç –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, —Ç–æ–ª—å–∫–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ

–ü—Ä–æ–±–ª–µ–º–∞ —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –≤ `ReferralModal` —Ä–µ—à–µ–Ω–∞.

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞*
