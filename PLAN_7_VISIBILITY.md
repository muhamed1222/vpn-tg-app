# –ö–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–∞—Ä–∏—Ñ –∑–∞ 10 —Ä—É–±–ª–µ–π (plan_7)

## üìã –£—Å–ª–æ–≤–∏—è –ø–æ–∫–∞–∑–∞ —Ç–∞—Ä–∏—Ñ–∞ plan_7

–¢–∞—Ä–∏—Ñ **plan_7** (7 –¥–Ω–µ–π –∑–∞ 10 —Ä—É–±–ª–µ–π) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ **–í–°–ï–•** —Å–ª–µ–¥—É—é—â–∏—Ö —É—Å–ª–æ–≤–∏–π:

### ‚úÖ –¢–∞—Ä–∏—Ñ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏:

1. **–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ù–ï–¢ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `api.getPaymentsHistory()`
   - –ò—â–µ—Ç—Å—è —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–ª–∞—Ç–µ–∂ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `'success'`
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Üí —Ç–∞—Ä–∏—Ñ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

2. **–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ù–ï–¢ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `api.getUserStatus()`
   - –ï—Å–ª–∏ `status === 'active'` ‚Üí —Ç–∞—Ä–∏—Ñ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

3. **–õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏**
   - –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   - –ï—Å–ª–∏ `subscription.status === 'active'` ‚Üí —Ç–∞—Ä–∏—Ñ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### ‚ùå –¢–∞—Ä–∏—Ñ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏:

- ‚úÖ –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂ (`status === 'success'`)
- ‚úÖ –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ (`status === 'active'`)
- ‚úÖ –ï—Å—Ç—å –∏—Å—Ç–µ–∫—à–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ (–Ω–æ –±—ã–ª–∏ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏)

## üîç –ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–∫—É–ø–∫–∏
**–§–∞–π–ª:** `app/(auth)/purchase/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 68-93, 136-139)

```typescript
const checkHasPaidOrders = async () => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π
  const payments = await api.getPaymentsHistory();
  const hasPaidPayments = payments.some(p => p.status === 'success');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
  const statusData = await api.getUserStatus();
  const hasActiveSubscription = statusData.ok && statusData.status === 'active';
  
  // –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –∏–ª–∏ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ - —Å–∫—Ä—ã–≤–∞–µ–º plan_7
  return hasPaidPayments || hasActiveSubscription;
};

// –ü—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
if (tariff.id === 'plan_7' && hasPaidOrders) {
  return false; // –°–∫—Ä—ã–≤–∞–µ–º —Ç–∞—Ä–∏—Ñ
}
```

### 2. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫—É–ø–∏—Ç—å (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞)
**–§–∞–π–ª:** `components/blocks/PurchaseConfirmModal.tsx` (—Å—Ç—Ä–æ–∫–∏ 138-153)

```typescript
if (planId === 'plan_7') {
  const payments = await api.getPaymentsHistory();
  const hasPaidOrders = payments.some(p => p.status === 'success');
  
  if (hasPaidOrders) {
    webApp.showAlert('–ü—Ä–æ–±–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Ç–∞—Ä–∏—Ñ.');
    return; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–∫—É–ø–∫—É
  }
}
```

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∫—É–ø–∫–∏
    ‚Üì
–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–∞—Ä–∏—Ñ—ã —Å –±—ç–∫–µ–Ω–¥–∞
    ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è checkHasPaidOrders():
    ‚îú‚îÄ –ï—Å—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏? ‚Üí –î–ê ‚Üí plan_7 —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚ùå
    ‚îú‚îÄ –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞? ‚Üí –î–ê ‚Üí plan_7 —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚ùå
    ‚îî‚îÄ –ù–µ—Ç –Ω–∏ —Ç–æ–≥–æ, –Ω–∏ –¥—Ä—É–≥–æ–≥–æ? ‚Üí plan_7 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π: –ø—É—Å—Ç–æ
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞: –Ω–µ—Ç
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** plan_7 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫—É–ø–∏–ª plan_7
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π: –µ—Å—Ç—å –ø–ª–∞—Ç–µ–∂ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'success'
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞: –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω–∞ –∏–ª–∏ –∏—Å—Ç–µ–∫–ª–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** plan_7 —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫—É–ø–∏–ª –¥—Ä—É–≥–æ–π —Ç–∞—Ä–∏—Ñ
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π: –µ—Å—Ç—å –ø–ª–∞—Ç–µ–∂ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'success'
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞: –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω–∞ –∏–ª–∏ –∏—Å—Ç–µ–∫–ª–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** plan_7 —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞, –Ω–æ –±—ã–ª–∏ –ø–ª–∞—Ç–µ–∂–∏
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π: –µ—Å—Ç—å –ø–ª–∞—Ç–µ–∂ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'success'
- ‚ùå –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞: –Ω–µ—Ç (–∏—Å—Ç–µ–∫–ª–∞)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** plan_7 —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–ø–æ—Ç–æ–º—É —á—Ç–æ –±—ã–ª–∏ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏)

## üîí –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞

1. **–ù–∞ —É—Ä–æ–≤–Ω–µ UI** - —Ç–∞—Ä–∏—Ñ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
2. **–ù–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–∫—É–ø–∫–∏** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫—É–ø–∏—Ç—å

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–º–æ–∂–µ—Ç –∫—É–ø–∏—Ç—å plan_7 –¥–≤–∞–∂–¥—ã, –¥–∞–∂–µ –µ—Å–ª–∏:
- –ö—ç—à —É—Å—Ç–∞—Ä–µ–ª
- API –≤–µ—Ä–Ω—É–ª —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É

## üìù –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ö—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∞—Ä–∏—Ñ–æ–≤:
   ```typescript
   removeCache('tariffs'); // –í—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   ```

2. **Fallback –ª–æ–≥–∏–∫–∞:**
   - –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
   - –ï—Å–ª–∏ –∏ —ç—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Ç–∞—Ä–∏—Ñ—ã (–≤–∫–ª—é—á–∞—è plan_7)

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**
   - –ë—ç–∫–µ–Ω–¥ —Ç–æ–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏ plan_7
   - –î–∞–∂–µ –µ—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç, –±—ç–∫–µ–Ω–¥ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç
