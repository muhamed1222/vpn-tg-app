# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–î–∞—Ç–∞:** 17 —è–Ω–≤–∞—Ä—è 2026  
**–ü—Ä–æ–±–ª–µ–º—ã:** CSP –æ—à–∏–±–∫–∞ –∏ 401 Unauthorized

---

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. CSP –æ—à–∏–±–∫–∞ —Å vercel.live
```
Refused to load the script 'https://vercel.live/_next-live/feedback/feedback.js' 
because it violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline' https://telegram.org https://app.request.finance"
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–∞ Vercel –≤ production `NODE_ENV` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ 'development', –Ω–æ Vercel Live –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `VERCEL_ENV` –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ `NODE_ENV`

### 2. 401 Unauthorized –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
```
GET https://my.outlivion.space/api/admin/contest/participants?contest_id=contest-20260117 401 (Unauthorized)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π ID –∫–æ–Ω–∫—É—Ä—Å–∞ `contest-20260117` (–¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω)
- –ó–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. `ADM` –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ server-side –∫–æ–¥–µ –Ω–∞ Vercel
2. –ê–¥–º–∏–Ω—Å–∫–∞—è —Å–µ—Å—Å–∏—è –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. Backend API –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. CSP –¥–ª—è vercel.live
**–§–∞–π–ª:** `next.config.ts`

**–ë—ã–ª–æ:**
```typescript
(process.env.NODE_ENV === 'development' ? " https://vercel.live" : "")
```

**–°—Ç–∞–ª–æ:**
```typescript
((process.env.NODE_ENV === 'development' || process.env.VERCEL_ENV === 'development') ? " https://vercel.live" : "")
```

### 2. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
**–§–∞–π–ª:** `app/api/admin/contest/participants/route.ts`

–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ `ADMIN_API_KEY` (ADM, ADMIN_API_KEY, NEXT_PUBLIC_ADMIN_API_KEY)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–∞ (–ø–µ—Ä–≤—ã–µ 3 —Å–∏–º–≤–æ–ª–∞)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `VERCEL_ENV`

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ 401 –æ—à–∏–±–∫–∏

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ Vercel —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
- `ADM` = `A246123b` (–∏–ª–∏ `ADMIN_API_KEY` = `A246123b`)

**–í–∞–∂–Ω–æ:** –ù–∞ Vercel –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `NEXT_PUBLIC_` –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ server-side –∫–æ–¥–µ (API routes).

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ Vercel

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç ‚Üí Deployments ‚Üí Latest
3. –û—Ç–∫—Ä–æ–π—Ç–µ Functions ‚Üí `/api/admin/contest/participants`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `[Admin API Debug]`

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–º–∏–Ω—Å–∫—É—é —Å–µ—Å—Å–∏—é

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. –í—ã –≤–æ—à–ª–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å –ø–∞—Ä–æ–ª–µ–º `A246123b`
2. Cookie `admin_session` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
3. Cookie –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö (`credentials: 'include'`)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel:**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `ADM` –∏–ª–∏ `ADMIN_API_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   - –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `A246123b`

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
   - –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Vercel Functions
   - –ù–∞–π—Ç–∏ `[Admin API Debug]` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend API:**
   ```bash
   curl https://api.outlivion.space/v1/admin/contest/participants?contest_id=550e8400-e29b-41d4-a716-446655440000 \
     -H "x-admin-api-key: A246123b"
   ```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- CSP –æ—à–∏–±–∫–∞ —Å `vercel.live` –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ - —ç—Ç–æ dev tool Vercel
- –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - 401 Unauthorized, —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è CSP –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ CSP –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è 401
